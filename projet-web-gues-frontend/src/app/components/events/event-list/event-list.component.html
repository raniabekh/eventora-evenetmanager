<!-- src/app/components/events/event-list/event-list.component.html -->
<div class="event-list-container">
  <!-- En-tÃªte -->
  <header class="page-header">
    <div class="header-content">
      <h1 class="page-title">Ã‰vÃ©nements Ã  venir</h1>
      <p class="page-subtitle">DÃ©couvrez des Ã©vÃ©nements passionnants</p>

      <div class="header-stats" *ngIf="!isLoading && !hasError">
        <div class="stat-item">
          <span class="stat-number">{{ filteredEvents.length }}</span>
          <span class="stat-label">Ã©vÃ©nements</span>
        </div>
        <div class="stat-item">
          <span class="stat-number">{{ categories.length }}</span>
          <span class="stat-label">catÃ©gories</span>
        </div>
      </div>
    </div>
  </header>

  <!-- Filtres -->
  <section class="filters-section">
    <div class="filters-card">
      <h3 class="filters-title">ğŸ” Rechercher</h3>

      <div class="search-container">
        <div class="search-input-group">
          <input
            type="text"
            [(ngModel)]="searchKeyword"
            placeholder="Rechercher..."
            (keyup.enter)="applyFilters()"
            class="search-input"
          >
          <button (click)="applyFilters()" class="search-button">ğŸ”</button>
        </div>
      </div>

      <div class="filter-options">
        <div class="filter-group">
          <label class="filter-label">CatÃ©gorie</label>
          <select [(ngModel)]="selectedCategory" class="filter-select">
            <option value="">Toutes</option>
            <option *ngFor="let cat of categories" [value]="cat.value">
              {{ cat.icon }} {{ cat.label }}
            </option>
          </select>
        </div>

        <div class="filter-group">
          <label class="filter-label">Lieu</label>
          <input
            type="text"
            [(ngModel)]="locationFilter"
            placeholder="Ville..."
            class="filter-input"
            (keyup.enter)="applyFilters()"
          >
        </div>

        <div class="filter-actions">
          <button (click)="applyFilters()" class="btn-apply">Appliquer</button>
          <button (click)="resetFilters()" class="btn-reset">RÃ©initialiser</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Contenu principal -->
  <main class="main-content">
    <!-- Chargement -->
    <div *ngIf="isLoading" class="loading-state">
      <div class="spinner"></div>
      <p>Chargement...</p>
    </div>

    <!-- Erreur -->
    <div *ngIf="hasError && !isLoading" class="error-state">
      <p>Erreur de chargement</p>
      <button (click)="loadEvents()" class="btn-retry">RÃ©essayer</button>
    </div>

    <!-- Liste vide -->
    <div *ngIf="!isLoading && !hasError && filteredEvents.length === 0" class="empty-state">
      <p>Aucun Ã©vÃ©nement trouvÃ©</p>
      <button (click)="resetFilters()" class="btn-retry">Voir tout</button>
    </div>

    <!-- Grille d'Ã©vÃ©nements -->
    <section *ngIf="!isLoading && !hasError && filteredEvents.length > 0" class="events-section">
      <h2 class="section-title">
        {{ filteredEvents.length }} Ã©vÃ©nement{{ filteredEvents.length > 1 ? 's' : '' }}
      </h2>

      <div class="events-grid">
        <div
          *ngFor="let event of paginatedEvents; trackBy: trackByEventId"
          class="event-card"
        >
          <!-- CatÃ©gorie -->
          <div class="event-category" [style.background]="getCategoryColor(event.category)">
            {{ getCategoryIcon(event.category) }}
          </div>

          <!-- Image -->
          <div class="event-image">
            <img
              [src]="getEventImage(event)"
              [alt]="event.title"
              class="event-img"
              loading="lazy"
              (error)="handleImageError($event)"
            >
            <div *ngIf="isEventFull(event)" class="event-full-badge">COMPLET</div>
          </div>

          <!-- Contenu -->
          <div class="event-content">
            <h3 class="event-title">{{ event.title }}</h3>

            <div class="event-meta">
              <span>ğŸ“… {{ formatShortDate(event.date) }} {{ formatTime(event.date) }}</span>
              <span>ğŸ“ {{ event.location }}</span>
            </div>

            <p class="event-description">{{ truncateText(event.description, 100) }}</p>

            <!-- CapacitÃ© -->
            <div class="event-capacity">
              <div class="capacity-info">
                <span>ğŸ‘¥ {{ getAvailableSpots(event) }}/{{ event.maxParticipants }}</span>
                <span>{{ getOccupancyPercentage(event) }}%</span>
              </div>
              <div class="capacity-bar">
                <div
                  class="bar-fill"
                  [style.width.%]="getOccupancyPercentage(event)"
                  [class.bar-full]="isEventFull(event)"
                ></div>
              </div>
            </div>

            <!-- Action -->
            <div class="event-action">
              <a [routerLink]="['/events', event.id]" class="btn-details">
                Voir dÃ©tails
              </a>
            </div>
          </div>
        </div>
      </div>

      <!-- Pagination -->
      <div *ngIf="totalPages > 1" class="pagination">
        <button (click)="prevPage()" [disabled]="currentPage === 1">â†</button>

        <button
          *ngFor="let page of pageNumbers"
          (click)="goToPage(page)"
          [class.active]="page === currentPage"
        >
          {{ page }}
        </button>

        <button (click)="nextPage()" [disabled]="currentPage === totalPages">â†’</button>
      </div>
    </section>
  </main>
</div>
